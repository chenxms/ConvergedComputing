---
name: 等级分布计算
status: open
created: 2025-09-04T19:20:00Z
updated: 2025-09-04T19:20:00Z
github: [Will be updated when synced to GitHub]
depends_on: [003]
parallel: true
conflicts_with: []
---

# Task: 等级分布计算

## Description
实现基于年级的等级分布计算逻辑，根据grade_level字段区分小学(1-6th_grade)和初中(7-9th_grade)，采用不同的分数阈值进行等级划分。提供灵活的等级定义和统计功能，支持个人等级判定和群体等级分布分析。

## Acceptance Criteria
- [ ] 实现基于grade_level的年级判断逻辑
- [ ] 实现小学等级划分：优秀(≥90)、良好(80-89)、及格(60-79)、不及格(<60)
- [ ] 实现初中等级划分：A等(≥85)、B等(70-84)、C等(60-69)、D等(<60)
- [ ] 支持等级分布统计：各等级人数和比例计算
- [ ] 实现等级趋势分析：等级分布的变化趋势
- [ ] 提供等级映射配置：支持自定义等级阈值调整

## Technical Details
- 年级识别：解析grade_level字段(1st_grade到9th_grade)
- 等级算法：基于分数区间的等级判定逻辑
- 批量处理：支持批量学生的等级计算
- 分布统计：等级人数统计和百分比计算
- 配置管理：等级阈值的配置化管理
- 涉及文件：app/Services/Statistical/GradeLevelDistributionCalculator.php, app/Config/GradeLevelThresholds.php

## Grade Level Mapping
```php
// 年级分组逻辑
const GRADE_GROUPS = [
    'elementary' => ['1st_grade', '2nd_grade', '3rd_grade', '4th_grade', '5th_grade', '6th_grade'],
    'middle_school' => ['7th_grade', '8th_grade', '9th_grade']
];

// 等级阈值配置
const GRADE_THRESHOLDS = [
    'elementary' => [
        'excellent' => 90,
        'good' => 80,
        'pass' => 60,
        'fail' => 0
    ],
    'middle_school' => [
        'A' => 85,
        'B' => 70,
        'C' => 60,
        'D' => 0
    ]
];
```

## Statistical Features
- 等级分布：各等级的学生人数和百分比
- 等级趋势：时间序列的等级分布变化
- 对比分析：不同班级、学校的等级分布对比
- 预警机制：低等级比例异常的预警提示

## Business Logic
- 年级适配：根据学生年级自动选择合适的等级标准
- 缺失处理：处理grade_level缺失或无效的情况
- 边界处理：处理分数边界值的等级归属
- 灵活配置：支持学校自定义等级标准

## Dependencies
- [ ] 任务003完成：基础统计计算引擎可用
- [ ] grade_level字段数据格式确认
- [ ] 小学/初中等级标准确认
- [ ] 等级阈值配置需求确认

## Effort Estimate
- Size: S-M
- Hours: 8-16小时
- Parallel: true (可与004、005、006并行)

## Definition of Done
- [ ] 代码实现完成：等级分布计算核心功能
- [ ] 年级识别测试：各年级的正确识别和分组
- [ ] 等级划分测试：不同年级等级标准的正确应用
- [ ] 分布统计测试：等级人数和比例计算准确性
- [ ] 配置功能测试：等级阈值自定义配置功能
- [ ] 文档完成：等级标准说明和配置指南
- [ ] 业务评审：教育专业人员的等级标准评审