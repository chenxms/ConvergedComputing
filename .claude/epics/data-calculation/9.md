---
name: 问卷数据处理
status: open
created: 2025-09-04T19:20:00Z
updated: 2025-09-04T19:34:05Z
github: https://github.com/chenxms/ConvergedComputing/issues/9
depends_on: [5, 6, 7, 8]
parallel: false
conflicts_with: []
---

# Task: 问卷数据处理

## Description
实现问卷数据的智能处理系统，支持正向/反向量表转换、5级李克特量表计分、选项频率统计等核心功能。提供完整的问卷数据处理管道，从原始问卷响应到标准化得分的转换，支持多种问卷类型和计分规则。

## Acceptance Criteria
- [ ] 实现正向量表计分：1分->1分, 2分->2分, 3分->3分, 4分->4分, 5分->5分
- [ ] 实现反向量表计分：1分->5分, 2分->4分, 3分->3分, 4分->2分, 5分->1分
- [ ] 支持5级李克特量表：完全不同意(1分), 不同意(2分), 中性(3分), 同意(4分), 完全同意(5分)
- [ ] 实现选项频率统计：各选项的选择次数和百分比分布
- [ ] 支持问卷维度汇总：多题目按维度的综合得分计算
- [ ] 实现缺失数据处理：空值、无效选项的处理策略

## Technical Details
- 量表处理：正向/反向计分规则的配置化管理
- 李克特量表：标准5级量表的分值映射
- 频率统计：选项分布的统计计算和可视化数据准备
- 维度汇总：按问卷设计的维度结构进行分数聚合
- 数据验证：问卷响应数据的完整性和有效性检查
- 涉及文件：app/Services/Survey/SurveyDataProcessor.php, app/Config/SurveyScaleConfig.php

## Scale Configuration
```php
// 量表类型配置
const SCALE_TYPES = [
    'forward' => [1 => 1, 2 => 2, 3 => 3, 4 => 4, 5 => 5],    // 正向量表
    'reverse' => [1 => 5, 2 => 4, 3 => 3, 4 => 2, 5 => 1]     // 反向量表
];

// 李克特量表标签配置
const LIKERT_LABELS = [
    1 => '完全不同意',
    2 => '不同意', 
    3 => '中性',
    4 => '同意',
    5 => '完全同意'
];

// 问卷维度配置示例
const SURVEY_DIMENSIONS = [
    'curiosity' => [
        'name' => '好奇心',
        'questions' => ['Q1', 'Q3', 'Q5'],  // 正向题目
        'reverse_questions' => ['Q2', 'Q4'] // 反向题目
    ],
    'observation' => [
        'name' => '观察能力',
        'questions' => ['Q6', 'Q8'],
        'reverse_questions' => ['Q7']
    ]
];
```

## Processing Pipeline
- 数据验证：检查问卷响应的完整性和合法性
- 量表转换：根据题目属性进行正向/反向计分
- 维度计算：按维度汇总题目得分
- 频率统计：计算各选项的分布情况
- 结果输出：生成标准化的问卷统计结果

## Business Logic
- 量表识别：自动识别题目的量表类型(正向/反向)
- 缺失处理：对空值和异常响应的处理策略
- 权重支持：支持题目权重的差异化计分
- 维度验证：确保维度配置与实际题目的对应关系
- 质量控制：识别和标记质量可疑的问卷响应

## Data Quality Rules
```php
// 数据质量检查规则
const QUALITY_RULES = [
    'response_time_min' => 30,        // 最少作答时间(秒)
    'response_time_max' => 1800,      // 最长作答时间(秒)
    'straight_line_max' => 10,        // 连续相同选项最大数量
    'completion_rate_min' => 0.8      // 最低完成率
];
```

## Statistical Features  
- 选项分布：各选项的频次和百分比统计
- 维度得分：各维度的平均分和标准差
- 相关分析：维度间的相关性统计
- 质量指标：问卷数据质量的评估指标

## Dependencies
- [ ] 任务004完成：描述性统计功能可用于频率计算
- [ ] 任务005完成：相关性分析可用于维度关联分析
- [ ] 任务006完成：回归分析可用于趋势预测
- [ ] 任务007完成：等级分布用于问卷得分分级
- [ ] 问卷维度结构和计分规则确认
- [ ] 李克特量表标准和标签确认

## Effort Estimate
- Size: M-L
- Hours: 16-24小时
- Parallel: false (需要依赖前序任务的算法支持)

## Definition of Done
- [ ] 代码实现完成：问卷数据处理核心功能
- [ ] 量表转换测试：正向/反向量表的正确转换
- [ ] 李克特量表测试：5级量表的正确计分
- [ ] 频率统计测试：选项分布统计的准确性
- [ ] 维度汇总测试：多题目维度得分的正确计算
- [ ] 数据质量测试：异常数据的正确识别和处理
- [ ] 性能测试：大量问卷数据的处理性能
- [ ] 文档完成：问卷处理规则和配置说明
- [ ] 业务评审：问卷专家的计分规则评审
